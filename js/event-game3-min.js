import{Timer}from"./timer.js";import{playSound,stopSound,playLowSound}from"./sound-functions.js";export function listenGame3Events(e){const t=document.getElementById("immune-system"),n=document.getElementById("pourcentage"),i=document.getElementsByClassName("game-over-or-next-game")[0],r=document.getElementsByClassName("win")[0],l=document.getElementById("btn-play-again"),s=document.getElementsByClassName("virus-green")[0],o=document.getElementsByClassName("virus-green")[1],a=document.getElementsByClassName("virus-purple")[0],d=document.getElementsByClassName("virus-purple")[1],m=document.getElementsByClassName("virus-blue")[0],c=document.getElementsByClassName("virus-blue")[1],u=document.getElementsByClassName("virus"),v=document.getElementById("death"),g=document.getElementById("countdown"),I=document.getElementById("heartbeat"),y=document.getElementById("cheering");let h=document.getElementById("minDec"),E=document.getElementById("minUni"),p=document.getElementById("secDec"),w=document.getElementById("secUni"),f=Number(localStorage.getItem("scoreGame2"));var B;function C(){var e,t;e=L.twoDigitsNumber(L.getMinutes()),h.textContent=e[0],E.textContent=e[1],t=L.twoDigitsNumber(L.getSeconds()),p.textContent=t[0],w.textContent=t[1]}t.style.width=`${f}%`,n.innerHTML=`${f}%`;var L=new Timer(45);class M{constructor(e,t,n,i,r){this.points=e,this.rowVorA=t,this.columnVorA=n,this.interval=i,this.element=r,this.intervalId=0}virusMove(){this.intervalId=setInterval(()=>{this.columnVorA=1+Math.floor(16*Math.random()),this.rowVorA=1+Math.floor(15*Math.random()),this.element.style.gridColumn=`${this.columnVorA}`,this.element.style.gridRow=`${this.rowVorA}`},this.interval)}virusClicked(){f>=100?f=100:f+this.points>=100?(f=100,t.style.width=`${f}%`,n.innerHTML=`${f}%`):(f+=this.points,t.style.width=`${f}%`,n.innerHTML=`${f}%`,console.log(this,this.points))}}let k=new M(2,2,2,1200,s),N=new M(2,3,2,1200,o),S=new M(5,10,5,900,a),x=new M(5,6,10,900,d),T=new M(7,6,10,800,m),$=new M(7,6,10,800,c);function A(){k.virusMove(),N.virusMove(),S.virusMove(),x.virusMove(),T.virusMove(),$.virusMove(),L.startTimer(C,H),playSound(I),B=setInterval(()=>{f-=2,t.style.width=`${f}%`,n.innerHTML=`${f}%`},1e3),V()}function b(){document.getElementById("sound").play()}function V(){if(f<=1){f=0,n.innerHTML="0%",i.classList.remove("game-over-or-next-game"),i.classList.add("game-over-or-next-game-display"),clearInterval(k.intervalId),clearInterval(N.intervalId),clearInterval(S.intervalId),clearInterval(x.intervalId),clearInterval(T.intervalId),clearInterval($.intervalId),clearInterval(L.intervalId),clearInterval(B),stopSound(I),playLowSound(v);for(let e=0;e<u.length;e++)u[e].style.display="none";return!1}return!0}function H(){r.classList.remove("win"),r.classList.add("game-over-or-next-game-display"),clearInterval(k.intervalId),clearInterval(N.intervalId),clearInterval(S.intervalId),clearInterval(x.intervalId),clearInterval(T.intervalId),clearInterval($.intervalId),clearInterval(B),stopSound(I),playSound(y);for(let e=0;e<u.length;e++)u[e].style.display="none"}l.onclick=function(){window.location.href="index.html"},setTimeout(()=>{s.addEventListener("click",function(){b(),k.virusClicked()}),o.addEventListener("click",function(){b(),k.virusClicked()}),a.addEventListener("click",function(){b(),S.virusClicked()}),d.addEventListener("click",function(){b(),x.virusClicked()}),m.addEventListener("click",function(){b(),T.virusClicked()}),c.addEventListener("click",function(){b(),$.virusClicked()})},5e3),requestAnimationFrame(function e(t){var n=!0;!1===(n=n&&V())||requestAnimationFrame(e)}),playSound(g),setTimeout(()=>{A()},5e3)}